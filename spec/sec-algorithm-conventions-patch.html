<emu-clause id="sec-algorithm-conventions">
  <h1>Algorithm Conventions</h1>
  <emu-clause id="sec-runtime-semantics">
    <h1>Runtime Semantics</h1>
    <ins class="block">
    <emu-clause id="sec-disposeifabrupt" aoid="DisposeIfAbrupt">
      <h1>DisposeIfAbrupt</h1>

      <p>Algorithm steps that say or are otherwise equivalent to:</p>
      <emu-alg>
        1. DisposeIfAbrupt(_argument_, _disposable_).
      </emu-alg>
      <p>mean the same thing as:</p>
      <emu-alg>
        1. Assert: _disposable_ is an object with a [[DisposableResourceStack]] internal slot or *undefined*.
        1. If _argument_ is an abrupt completion, set _argument_ to DisposeResources(_disposable_, _argument_).
      </emu-alg>

      <p>Algorithm steps that say or are otherwise equivalent to:</p>
      <emu-alg>
        1. DisposeIfAbrupt(_argument_, _disposable_, _errors_).
      </emu-alg>
      <p>mean the same thing as:</p>
      <emu-alg>
        1. Assert: _disposable_ is an object with a [[DisposableResourceStack]] internal slot or *undefined*.
        1. Assert: _errors_ is a List.
        1. If _argument_ is an abrupt completion, set _argument_ to DisposeResources(_disposable_, _argument_, _errors_).
      </emu-alg>

      <p>Algorithm steps that say or are otherwise equivalent to:</p>
      <emu-alg>
        1. DisposeIfAbrupt(AbstractOperation(), _disposable_).
      </emu-alg>
      <p>mean the same thing as:</p>
      <emu-alg>
        1. Assert: _disposable_ is an object with a [[DisposableResourceStack]] internal slot or *undefined*.
        1. Let _hygienicTemp_ be AbstractOperation().
        1. If _hygienicTemp_ is an abrupt completion, set _hygienicTemp_ to DisposeResources(_disposable_, _hygienicTemp_).
      </emu-alg>
      <p>Where _hygienicTemp_ is ephemeral and visible only in the steps pertaining to DisposeIfAbrupt.</p>

      <p>Algorithm steps that say or are otherwise equivalent to:</p>
      <emu-alg>
        1. DisposeIfAbrupt(AbstractOperation(), _disposable_, _errors_).
      </emu-alg>
      <p>mean the same thing as:</p>
      <emu-alg>
        1. Assert: _disposable_ is an object with a [[DisposableResourceStack]] internal slot or *undefined*.
        1. Assert: _errors_ is a List.
        1. Let _hygienicTemp_ be AbstractOperation().
        1. If _hygienicTemp_ is an abrupt completion, set _hygienicTemp_ to DisposeResources(_disposable_, _hygienicTemp_, _errors_).
      </emu-alg>
      <p>Where _hygienicTemp_ is ephemeral and visible only in the steps pertaining to DisposeIfAbrupt.</p>

      <p>Algorithm steps that say or are otherwise equivalent to:</p>
      <emu-alg>
        1. Let _result_ be AbstractOperation(DisposeIfAbrupt(_argument_, _disposable_)).
      </emu-alg>
      <p>mean the same thing as:</p>
      <emu-alg>
        1. Assert: _disposable_ is an object with a [[DisposableResourceStack]] internal slot or *undefined*.
        1. If _argument_ is an abrupt completion, set _argument_ to DisposeResources(_disposable_, _argument_).
        1. Let _result_ be AbstractOperation(_argument_).
      </emu-alg>

      <p>Algorithm steps that say or are otherwise equivalent to:</p>
      <emu-alg>
        1. Let _result_ be AbstractOperation(DisposeIfAbrupt(_argument_, _disposable_, _errors_)).
      </emu-alg>
      <p>mean the same thing as:</p>
      <emu-alg>
        1. Assert: _disposable_ is an object with a [[DisposableResourceStack]] internal slot or *undefined*.
        1. Assert: _errors_ is a List.
        1. If _argument_ is an abrupt completion, set _argument_ to DisposeResources(_disposable_, _argument_, _errors_).
        1. Let _result_ be AbstractOperation(_argument_).
      </emu-alg>

      <emu-note>
        <p>DisposeIfAbrupt can be combined with the `?` and `!` prefixes, so that for example</p>
        <emu-alg>
          1. Let _result_ be ? DisposeIfAbrupt(_value_, _disposable_).
        </emu-alg>
        <p>means the same thing as:</p>
        <emu-alg>
          1. Let _result_ be DisposeIfAbrupt(_value_, _disposable_).
          1. ReturnIfAbrupt(_result_).
        </emu-alg>
      </emu-note>
    </emu-clause>
    </ins>
  </emu-clause>
</emu-clause>